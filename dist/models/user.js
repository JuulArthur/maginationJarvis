"use strict";
var bcrypt = require('bcryptjs');
var SALT_ROUNDS = 8;
module.exports = (function(collection, mongoose) {
  var schema = mongoose.Schema({
    username: {
      type: String,
      required: true,
      index: true,
      unique: true
    },
    password: {
      type: String,
      required: true
    }
  });
  schema.pre('save', function(next) {
    var user = this;
    bcrypt.genSalt(SALT_ROUNDS, (function(err, salt) {
      bcrypt.hash(user.password, salt, (function(err, hash) {
        user.password = hash;
        next();
      }));
    }));
  });
  schema.methods.validPassword = function(password, cb) {
    bcrypt.compare(password, this.password, (function(err, res) {
      return cb(err, res);
    }));
  };
  return mongoose.model(collection, schema);
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZGVscy91c2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsQUFBSSxFQUFBLENBQUEsTUFBSyxFQUFJLENBQUEsT0FBTSxBQUFDLENBQUMsVUFBUyxDQUFDLENBQUM7QUFDaEMsQUFBSSxFQUFBLENBQUEsV0FBVSxFQUFJLEVBQUEsQ0FBQztBQUVuQixLQUFLLFFBQVEsSUFBSSxTQUFDLFVBQVMsQ0FBRyxDQUFBLFFBQU87QUFDakMsQUFBSSxJQUFBLENBQUEsTUFBSyxFQUFJLENBQUEsUUFBTyxPQUFPLEFBQUMsQ0FBQztBQUN6QixXQUFPLENBQUc7QUFDTixTQUFHLENBQUcsT0FBSztBQUNYLGFBQU8sQ0FBRyxLQUFHO0FBQ2IsVUFBSSxDQUFHLEtBQUc7QUFDVixXQUFLLENBQUcsS0FBRztBQUFBLElBQ2Y7QUFDQSxXQUFPLENBQUc7QUFDTixTQUFHLENBQUcsT0FBSztBQUNYLGFBQU8sQ0FBRyxLQUFHO0FBQUEsSUFDakI7QUFBQSxFQUNKLENBQUMsQ0FBQztBQUdGLE9BQUssSUFBSSxBQUFDLENBQUMsTUFBSyxDQUFHLFVBQVUsSUFBRztBQUM1QixBQUFJLE1BQUEsQ0FBQSxJQUFHLEVBQUksS0FBRyxDQUFDO0FBQ2YsU0FBSyxRQUFRLEFBQUMsQ0FBQyxXQUFVLEdBQUcsU0FBQyxHQUFFLENBQUcsQ0FBQSxJQUFHO0FBQ2pDLFdBQUssS0FBSyxBQUFDLENBQUMsSUFBRyxTQUFTLENBQUcsS0FBRyxHQUFHLFNBQUMsR0FBRSxDQUFHLENBQUEsSUFBRyxDQUFLO0FBQzNDLFdBQUcsU0FBUyxFQUFJLEtBQUcsQ0FBQztBQUNwQixXQUFHLEFBQUMsRUFBQyxDQUFDO01BQ1YsRUFBQyxDQUFDO0lBQ04sRUFBQyxDQUFDO0VBQ04sQ0FBQyxDQUFDO0FBRUYsT0FBSyxRQUFRLGNBQWMsRUFBSSxVQUFVLFFBQU8sQ0FBRyxDQUFBLEVBQUM7QUFDaEQsU0FBSyxRQUFRLEFBQUMsQ0FBQyxRQUFPLENBQUcsQ0FBQSxJQUFHLFNBQVMsR0FBRyxTQUFDLEdBQUUsQ0FBRyxDQUFBLEdBQUUsQ0FBSztBQUNqRCxXQUFPLENBQUEsRUFBQyxBQUFDLENBQUMsR0FBRSxDQUFHLElBQUUsQ0FBQyxDQUFDO0lBQ3ZCLEVBQUMsQ0FBQztFQUNOLENBQUM7QUFFRCxPQUFPLENBQUEsUUFBTyxNQUFNLEFBQUMsQ0FBQyxVQUFTLENBQUcsT0FBSyxDQUFDLENBQUM7QUFFN0MsQ0FBQSxDQUFDO0FBQUEiLCJmaWxlIjoibW9kZWxzL3VzZXIuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKTtcbnZhciBTQUxUX1JPVU5EUyA9IDg7XG5cbm1vZHVsZS5leHBvcnRzID0gKGNvbGxlY3Rpb24sIG1vbmdvb3NlKSA9PiB7XG4gICAgdmFyIHNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYSh7XG4gICAgICAgIHVzZXJuYW1lOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIGluZGV4OiB0cnVlLFxuICAgICAgICAgICAgdW5pcXVlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIHBhc3N3b3JkOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9XG4gICAgfSk7XG5cblxuICAgIHNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCl7XG4gICAgICAgIHZhciB1c2VyID0gdGhpcztcbiAgICAgICAgYmNyeXB0LmdlblNhbHQoU0FMVF9ST1VORFMsIChlcnIsIHNhbHQpPT4ge1xuICAgICAgICAgICAgYmNyeXB0Lmhhc2godXNlci5wYXNzd29yZCwgc2FsdCwgKGVyciwgaGFzaCk9PiB7XG4gICAgICAgICAgICAgICAgdXNlci5wYXNzd29yZCA9IGhhc2g7XG4gICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgc2NoZW1hLm1ldGhvZHMudmFsaWRQYXNzd29yZCA9IGZ1bmN0aW9uIChwYXNzd29yZCwgY2IpIHtcbiAgICAgICAgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHRoaXMucGFzc3dvcmQgLChlcnIsIHJlcyk9PiB7XG4gICAgICAgICAgICByZXR1cm4gY2IoZXJyLCByZXMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIG1vbmdvb3NlLm1vZGVsKGNvbGxlY3Rpb24sIHNjaGVtYSk7XG5cbn07Il19