"use strict";
var chai = require('chai');
var should = chai.should();
var assert = chai.assert;
module.exports = (function(models) {
  describe("User", (function() {
    var testUser = {
      username: "test",
      password: "prompetiss"
    };
    before((function(done) {
      new models.User(testUser).save((function(err, usr) {
        should.not.exist(err);
        done();
      }));
    }));
    after((function(done) {
      models.User.remove({}, done);
    }));
    it('should be able to be found in the db', (function(done) {
      models.User.findOne({username: testUser.username}, (function(err, usr) {
        should.not.exist(err);
        should.exist(usr);
        usr.username.should.equal(testUser.username, 'retrieved username should match the saved username');
        usr.password.should.not.equal(testUser.password, 'password should be hashed before save');
        done();
      }));
    }));
    it('should be able to validate password', (function(done) {
      models.User.findOne({username: testUser.username}, (function(err, usr) {
        usr.validPassword(testUser.password, (function(err, res) {
          should.not.exist(err, 'password validation should not have errors');
          assert(res, 'password should be valid');
          done();
        }));
      }));
    }));
  }));
  describe("Election", (function() {
    var testElection = new models.Election({
      title: "test1",
      description: "prompetiss"
    });
    var testAlternative = new models.Alternative({description: 'asdadsad'});
    var testAlternative2 = new models.Alternative({description: 'asdadsadasd'});
    testElection.addAlternative(testAlternative);
    testElection.addAlternative(testAlternative2);
    before((function(done) {
      testElection.save((function(err) {
        should.not.exist(err);
        testAlternative.save((function(err) {
          should.not.exist(err);
          testAlternative2.save(done);
        }));
      }));
    }));
    after((function(done) {
      models.Election.remove({}, (function() {
        models.Alternative.remove({}, done);
      }));
    }));
    it('should be able to be found in the db', (function(done) {
      models.Election.findById(testElection._id).populate('alternatives').exec((function(err, el) {
        should.not.exist(err);
        should.exist(el);
        el.title.should.equal(testElection.title, 'retrieved title should match the saved title');
        el.description.should.equal(testElection.description, 'retrieved description should match the saved description');
        el.alternatives[0]._id.toString().should.equal(testAlternative._id.toString());
        el.alternatives[1]._id.toString().should.equal(testAlternative2._id.toString());
        done();
      }));
    }));
  }));
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvbW9kZWxzL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsQUFBSSxFQUFBLENBQUEsSUFBRyxFQUFJLENBQUEsT0FBTSxBQUFDLENBQUMsTUFBSyxDQUFDLENBQUM7QUFDMUIsQUFBSSxFQUFBLENBQUEsTUFBSyxFQUFJLENBQUEsSUFBRyxPQUFPLEFBQUMsRUFBQyxDQUFDO0FBQzFCLEFBQUksRUFBQSxDQUFBLE1BQUssRUFBSSxDQUFBLElBQUcsT0FBTyxDQUFDO0FBRXhCLEtBQUssUUFBUSxJQUFJLFNBQUEsTUFBSztBQUNsQixTQUFPLEFBQUMsQ0FBQyxNQUFLLEdBQUcsU0FBQSxBQUFDO0FBQ2QsQUFBSSxNQUFBLENBQUEsUUFBTyxFQUFJO0FBQ1gsYUFBTyxDQUFHLE9BQUs7QUFDZixhQUFPLENBQUcsYUFBVztBQUFBLElBQ3pCLENBQUM7QUFDRCxTQUFLLEFBQUMsRUFBQyxTQUFBLElBQUc7QUFDTixRQUFJLENBQUEsTUFBSyxLQUFLLEFBQUMsQ0FBQyxRQUFPLENBQUMsS0FBSyxBQUFDLEVBQUMsU0FBQyxHQUFFLENBQUcsQ0FBQSxHQUFFLENBQUs7QUFDeEMsYUFBSyxJQUFJLE1BQU0sQUFBQyxDQUFDLEdBQUUsQ0FBQyxDQUFDO0FBQ3JCLFdBQUcsQUFBQyxFQUFDLENBQUM7TUFDVixFQUFDLENBQUM7SUFDTixFQUFDLENBQUM7QUFDRixRQUFJLEFBQUMsRUFBQyxTQUFBLElBQUcsQ0FBSztBQUNWLFdBQUssS0FBSyxPQUFPLEFBQUMsQ0FBQyxFQUFDLENBQUcsS0FBRyxDQUFDLENBQUM7SUFDaEMsRUFBQyxDQUFDO0FBQ0YsS0FBQyxBQUFDLENBQUMsc0NBQXFDLEdBQUcsU0FBQSxJQUFHO0FBQzFDLFdBQUssS0FBSyxRQUFRLEFBQUMsQ0FBQyxDQUFDLFFBQU8sQ0FBRyxDQUFBLFFBQU8sU0FBUyxDQUFDLEdBQUcsU0FBQyxHQUFFLENBQUcsQ0FBQSxHQUFFLENBQUs7QUFDNUQsYUFBSyxJQUFJLE1B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RUFBQyxDQUFDLENBQUM7QUFDaEIsU0FBQyxNQUFNLE9BQU8sTUFBTSxBQUFDLENBQUMsWUFBVyxNQUFNLENBQUcsK0NBQTZDLENBQUMsQ0FBQztBQUN6RixTQUFDLFlBQVksT0FBTyxNQUFNLEFBQUMsQ0FBQyxZQUFXLFlBQVksQ0FBRywyREFBeUQsQ0FBQyxDQUFDO0FBQ2pILFNBQUMsYUFBYSxDQUFFLENBQUEsQ0FBQyxJQUFJLFNBQVMsQUFBQyxFQUFDLE9BQU8sTUFBTSxBQUFDLENBQUMsZUFBYyxJQUFJLFNBQVMsQUFBQyxFQUFDLENBQUMsQ0FBQztBQUM5RSxTQUFDLGFBQWEsQ0FBRSxDQUFBLENBQUMsSUFBSSxTQUFTLEFBQUMsRUFBQyxPQUFPLE1BQU0sQUFBQyxDQUFDLGdCQUFlLElBQUksU0FBUyxBQUFDLEVBQUMsQ0FBQyxDQUFDO0FBQy9FLFdBQUcsQUFBQyxFQUFDLENBQUM7TUFDVixFQUFDLENBQUM7SUFDVixFQUFDLENBQUM7RUFDTixFQUFDLENBQUM7QUFDTixDQUFBLENBQUM7QUFFRCIsImZpbGUiOiJ0ZXN0L21vZGVscy9pbmRleC5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLiIsInNvdXJjZXNDb250ZW50IjpbInZhciBjaGFpID0gcmVxdWlyZSgnY2hhaScpO1xudmFyIHNob3VsZCA9IGNoYWkuc2hvdWxkKCk7XG52YXIgYXNzZXJ0ID0gY2hhaS5hc3NlcnQ7XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kZWxzID0+IHtcbiAgICBkZXNjcmliZShcIlVzZXJcIiwgKCk9PiB7XG4gICAgICAgIHZhciB0ZXN0VXNlciA9IHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiBcInRlc3RcIixcbiAgICAgICAgICAgIHBhc3N3b3JkOiBcInByb21wZXRpc3NcIlxuICAgICAgICB9O1xuICAgICAgICBiZWZvcmUoZG9uZSA9PiB7XG4gICAgICAgICAgICBuZXcgbW9kZWxzLlVzZXIodGVzdFVzZXIpLnNhdmUoKGVyciwgdXNyKT0+IHtcbiAgICAgICAgICAgICAgICBzaG91bGQubm90LmV4aXN0KGVycik7XG4gICAgICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBhZnRlcihkb25lID0+IHtcbiAgICAgICAgICAgIG1vZGVscy5Vc2VyLnJlbW92ZSh7fSwgZG9uZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnc2hvdWxkIGJlIGFibGUgdG8gYmUgZm91bmQgaW4gdGhlIGRiJywgZG9uZSA9PiB7XG4gICAgICAgICAgICBtb2RlbHMuVXNlci5maW5kT25lKHt1c2VybmFtZTogdGVzdFVzZXIudXNlcm5hbWV9LCAoZXJyLCB1c3IpPT4ge1xuICAgICAgICAgICAgICAgIHNob3VsZC5ub3QuZXhpc3QoZXJyKTtcbiAgICAgICAgICAgICAgICBzaG91bGQuZXhpc3QodXNyKTtcbiAgICAgICAgICAgICAgICB1c3IudXNlcm5hbWUuc2hvdWxkLmVxdWFsKHRlc3RVc2VyLnVzZXJuYW1lLCAncmV0cmlldmVkIHVzZXJuYW1lIHNob3VsZCBtYXRjaCB0aGUgc2F2ZWQgdXNlcm5hbWUnKTtcbiAgICAgICAgICAgICAgICB1c3IucGFzc3dvcmQuc2hvdWxkLm5vdC5lcXVhbCh0ZXN0VXNlci5wYXNzd29yZCwgJ3Bhc3N3b3JkIHNob3VsZCBiZSBoYXNoZWQgYmVmb3JlIHNhdmUnKTtcbiAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgYmUgYWJsZSB0byB2YWxpZGF0ZSBwYXNzd29yZCcsIGRvbmUgPT4ge1xuICAgICAgICAgICAgbW9kZWxzLlVzZXIuZmluZE9uZSh7dXNlcm5hbWU6IHRlc3RVc2VyLnVzZXJuYW1lfSwgKGVyciwgdXNyKT0+IHtcbiAgICAgICAgICAgICAgICB1c3IudmFsaWRQYXNzd29yZCh0ZXN0VXNlci5wYXNzd29yZCwgKGVyciwgcmVzKT0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkLm5vdC5leGlzdChlcnIsICdwYXNzd29yZCB2YWxpZGF0aW9uIHNob3VsZCBub3QgaGF2ZSBlcnJvcnMnKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHJlcywgJ3Bhc3N3b3JkIHNob3VsZCBiZSB2YWxpZCcpO1xuICAgICAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZShcIkVsZWN0aW9uXCIsICgpPT4ge1xuICAgICAgICB2YXIgdGVzdEVsZWN0aW9uPSBuZXcgbW9kZWxzLkVsZWN0aW9uKHtcbiAgICAgICAgICAgIHRpdGxlOiBcInRlc3QxXCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJwcm9tcGV0aXNzXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB0ZXN0QWx0ZXJuYXRpdmUgPSBuZXcgbW9kZWxzLkFsdGVybmF0aXZlKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnYXNkYWRzYWQnXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgdGVzdEFsdGVybmF0aXZlMiA9IG5ldyBtb2RlbHMuQWx0ZXJuYXRpdmUoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdhc2RhZHNhZGFzZCdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdEVsZWN0aW9uLmFkZEFsdGVybmF0aXZlKHRlc3RBbHRlcm5hdGl2ZSk7XG4gICAgICAgIHRlc3RFbGVjdGlvbi5hZGRBbHRlcm5hdGl2ZSh0ZXN0QWx0ZXJuYXRpdmUyKTtcblxuICAgICAgICBiZWZvcmUoZG9uZSA9PiB7XG4gICAgICAgICAgICB0ZXN0RWxlY3Rpb24uc2F2ZShlcnIgPT4ge1xuICAgICAgICAgICAgICAgIHNob3VsZC5ub3QuZXhpc3QoZXJyKTtcbiAgICAgICAgICAgICAgICB0ZXN0QWx0ZXJuYXRpdmUuc2F2ZShlcnIgPT57XG4gICAgICAgICAgICAgICAgICAgIHNob3VsZC5ub3QuZXhpc3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgdGVzdEFsdGVybmF0aXZlMi5zYXZlKGRvbmUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBhZnRlcihkb25lID0+IHtcbiAgICAgICAgICAgIG1vZGVscy5FbGVjdGlvbi5yZW1vdmUoe30sICgpPT57XG4gICAgICAgICAgICAgICAgbW9kZWxzLkFsdGVybmF0aXZlLnJlbW92ZSh7fSwgZG9uZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdzaG91bGQgYmUgYWJsZSB0byBiZSBmb3VuZCBpbiB0aGUgZGInLCBkb25lID0+IHtcbiAgICAgICAgICAgIG1vZGVscy5FbGVjdGlvbi5maW5kQnlJZCh0ZXN0RWxlY3Rpb24uX2lkKVxuICAgICAgICAgICAgICAgIC5wb3B1bGF0ZSgnYWx0ZXJuYXRpdmVzJylcbiAgICAgICAgICAgICAgICAuZXhlYygoZXJyLCBlbCk9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNob3VsZC5ub3QuZXhpc3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkLmV4aXN0KGVsKTtcbiAgICAgICAgICAgICAgICAgICAgZWwudGl0bGUuc2hvdWxkLmVxdWFsKHRlc3RFbGVjdGlvbi50aXRsZSwgJ3JldHJpZXZlZCB0aXRsZSBzaG91bGQgbWF0Y2ggdGhlIHNhdmVkIHRpdGxlJyk7XG4gICAgICAgICAgICAgICAgICAgIGVsLmRlc2NyaXB0aW9uLnNob3VsZC5lcXVhbCh0ZXN0RWxlY3Rpb24uZGVzY3JpcHRpb24sICdyZXRyaWV2ZWQgZGVzY3JpcHRpb24gc2hvdWxkIG1hdGNoIHRoZSBzYXZlZCBkZXNjcmlwdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICBlbC5hbHRlcm5hdGl2ZXNbMF0uX2lkLnRvU3RyaW5nKCkuc2hvdWxkLmVxdWFsKHRlc3RBbHRlcm5hdGl2ZS5faWQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgIGVsLmFsdGVybmF0aXZlc1sxXS5faWQudG9TdHJpbmcoKS5zaG91bGQuZXF1YWwodGVzdEFsdGVybmF0aXZlMi5faWQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG4iXX0=